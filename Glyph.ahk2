; DIRECTIVES ==============================================
{
	#SingleInstance Force ; Prevents multiple versions of script from running
	SendMode("Input") ; Makes Send synonymous with SendInput
	#UseHook ; Helps prevent modifier key remaining stuck down
	A_MenuMaskKey := "vkFF" ; Helps prevent modifier key remaining stuck down
	SetTitleMatchMode(2)
}


; HOTKEYS =================================================
CapsLock & a::
CapsLock & b::
CapsLock & c::
CapsLock & d::
CapsLock & e::
CapsLock & f::
CapsLock & g::
CapsLock & h::
CapsLock & i::
CapsLock & j::
CapsLock & k::
CapsLock & l::
CapsLock & m::
CapsLock & n::
CapsLock & o::
CapsLock & p::
CapsLock & r::
CapsLock & s::
CapsLock & t::
CapsLock & u::
CapsLock & v::
CapsLock & w::
CapsLock & x::
CapsLock & y::
CapsLock & z::
{
	Global
	; Destroys GUI if it already exists
	If WinExist("Select a character to insert - Glyph") {
		GlyphGUI_Destroy()
	}

	ActiveHwnd := WinExist("A") ; Saves active window to Send to later

	capitalized := GetKeyState("Shift", "P") ; Checks for capitalization
	this_letter := SubStr(A_ThisHotkey, -1) ; Strips letter from hotkey

	launch_Glyph(this_letter)

	SetCapsLockState("AlwaysOff") ; Prevents Capslock being turned on accidentally
}


#HotIf WinActive("Select a character to insert - Glyph")
Enter::
NumpadEnter::{
	Global
	Send_Glyph(GlyphListView)
}

BackSpace::{
	GlyphGUI_Destroy()
}


1::
2::
3::
4::
5::
6::
7::
8::
9::
0::
Numpad1::
Numpad2::
Numpad3::
Numpad4::
Numpad5::
Numpad6::
Numpad7::
Numpad8::
Numpad9::
Numpad0::{
	; Sends the first/second/etc. glyph from the list
	Global
	this_number := SubStr(A_ThisHotkey, -1, 1) ; Strips the number from the hotkey
	If this_number = 0 {
		this_number := 10
	}

	Try { ; Will fail if there is no glyph in that position number
		GlyphListView.Modify(this_number, "Focus Select") ; Selects the appropriate row
	}

	this_row_num := GlyphListView.GetNext(2, "Focused")
	this_glyph := GlyphListView.GetText(this_row_num, 2)

	Send_Glyph(GlyphListView)
}

; FUNCTIONS ===============================================
Launch_Glyph(this_letter) {
	Global
	glyph_list := %this_letter%_Glyphs

	; Create the GUI
	GlyphGUI := Gui()
	GlyphGUI.Title := "Select a character to insert - Glyph"
	GlyphGUI.MarginX := 0
	GlyphGUI.MarginY := 0
	GlyphGUI.Opt("+AlwaysOnTop -MaximizeBox -MinimizeBox")
	GlyphGUI.SetFont("s12")

	GlyphListView := GlyphGUI.Add("ListView", "X+M R11 w275 T36 -Hdr", [
		"Diacritic",
		"Ch",
		"#"
	])


	Loop glyph_list.Length {
		If A_Index < 11 {
			GlyphListView.Add("", glyph_list[A_Index][2], glyph_list[A_Index][1], SubStr(A_Index, -1, 1))
		}
		Else {
			GlyphListView.Add("", glyph_list[A_Index][2], glyph_list[A_Index][1])
		}
	}

	GlyphListView.ModifyCol(1)


	GlyphGUI.Add("Text", "w275 Center", "Backspace or Escape to cancel")

	; GUI Events
	GlyphListView.OnEvent("DoubleClick", Send_Glyph)
	GlyphListView.OnEvent("LoseFocus", GlyphGUI_Destroy)
	GlyphGUI.OnEvent("Escape", GlyphGUI_Destroy)

	; Position GUI near mouse cursor
	CoordMode "Mouse", "Screen"
	MouseGetPos(&MouseX, &MouseY)
	GlyphGUI.Show("x" . MouseX - 10. " y" . MouseY - 5 . "Autosize")
}


Send_Glyph(GuiCtrlObj, *) {
	this_row_num := GuiCtrlObj.GetNext()

	If this_row_num = 0 {
		this_row_num := 1
	}


	this_glyph := GuiCtrlObj.GetText(this_row_num, 2)
	GlyphGUI_Destroy()

	; Reactivates previous window to Send to
	Try { ; May fail if the previously active window was closed
		WinActivate(ActiveHwnd)
	}
	Catch {
		Sleep(250) ; Gives another window a chance to activate instead of the GUI or ActiveHwnd
	}

	; Sends as capitalized or lowercase
	If capitalized {
		Send(this_glyph)
	}
	Else Send(StrLower(this_glyph))
}

GlyphGUI_Destroy(*) {
	Global
	GlyphGUI.Destroy()
}


; GLYPH ARRAYS ============================================
; Apologies for the scrolling; there's nothing interesting after this.
A_Glyphs := [
	[
		"Á",
		"Acute"
	],
	[
		"À",
		"Grave"
	],
	[
		"Ȧ",
		"Dot above"
	],
	[
		"Â",
		"Circumflex"
	],
	[
		"Ä",
		"Diaeresis"
	],
	[
		"Ǎ",
		"Caron"
	],
	[
		"Ă",
		"Breve"
	],
	[
		"Ā",
		"Macron"
	],
	[
		"Ã",
		"Tilde"
	],
	[
		"Å",
		"Ring above"
	],
	[
		"Ą",
		"Ogonek"
	],
	[
		"Ấ",
		"Circumflex and acute"
	],
	[
		"Ầ",
		"Circumflex and grave"
	],
	[
		"Ắ",
		"Breve and acute"
	],
	[
		"Ằ",
		"Breve and grave"
	],
	[
		"Ǡ",
		"Dot above and macron"
	],
	[
		"Ǻ",
		"Ring above and acute"
	],
	[
		"Ǟ",
		"Diaeresis and macron"
	],
	[
		"Ẫ",
		"Circumflex and tilde"
	],
	[
		"Ẵ",
		"Breve and tilde"
	],
	[
		"Ả",
		"Hook above"
	],
	[
		"Ȁ",
		"Double grave"
	],
	[
		"Ȃ",
		"Inverted breve"
	],
	[
		"Ẩ",
		"Circumflex and hook above"
	],
	[
		"Ẳ",
		"Breve and hook above"
	],
	[
		"Ạ",
		"Dot below"
	],
	[
		"Ḁ",
		"Ring below"
	],
	[
		"Ậ",
		"Circumflex and dot below"
	],
	[
		"Ặ",
		"Breve and dot below"
	],
	[
		"Æ",
		"Ash"
	],
	[
		"Ǽ",
		"Ash with acute"
	],
	[
		"Ǣ",
		"Ash with macron"
	]
]

B_Glyphs :=
	[
		[
			"Ḃ",
			"Dot above"
		],
		[
			"Ḅ",
			"Dot below"
		],
		[
			"Ḇ",
			"Macron below"
		]
	]
C_Glyphs :=
	[
		[
			"Ć",
			"Acute"
		],
		[
			"Ċ",
			"Dot above"
		],
		[
			"Ĉ",
			"Circumflex"
		],
		[
			"Č",
			"Caron"
		],
		[
			"Ç",
			"Cedilla"
		],
		[
			"Ȼ",
			"Stroke"
		],
		[
			"Ḉ",
			"Cedilla and acute"
		],
		[
			"Ƈ",
			"Hook"
		],
		[
			"Ꞓ",
			"Bar"
		],
		[
			"Ꞔ",
			"Palatal hook"
		]
	]

D_Glyphs := [
	[
		"Ḋ",
		"Dot above"
	],
	[
		"Ď",
		"Caron"
	],
	[
		"Ḑ",
		"Cedilla"
	],
	[
		"Ꟈ",
		"Short stroke overlay"
	],
	[
		"Đ",
		"Stroke through stem"
	],
	[
		"Ƌ",
		"Topbar"
	],
	[
		"Ɗ",
		"Hook"
	],
	[
		"Ḍ",
		"Dot below"
	],
	[
		"Ḓ",
		"Circumflex below"
	],
	[
		"Ḏ",
		"Macron below"
	],
	[
		"Ɖ",
		"Tail"
	]
]

E_Glyphs :=
	[
		[
			"É",
			"Acute"
		],
		[
			"È",
			"Grave"
		],
		[
			"Ė",
			"Dot above"
		],
		[
			"Ê",
			"Circumflex"
		],
		[
			"Ë",
			"Diaeresis"
		],
		[
			"Ě",
			"Caron"
		],
		[
			"Ĕ",
			"Breve"
		],
		[
			"Ē",
			"Macron"
		],
		[
			"Ẽ",
			"Tilde"
		],
		[
			"Ę",
			"Ogonek"
		],
		[
			"Ȩ",
			"Cedilla"
		],
		[
			"Ế",
			"Circumflex and acute"
		],
		[
			"Ề",
			"Circumflex and grave"
		],
		[
			"Ḗ",
			"Macron and acute"
		],
		[
			"Ḕ",
			"Macron and grave"
		],
		[
			"Ễ",
			"Circumflex and tilde"
		],
		[
			"Ḝ",
			"Cedilla and breve"
		],
		[
			"Ẻ",
			"Hook above"
		],
		[
			"Ȅ",
			"Double grave"
		],
		[
			"Ȇ",
			"Inverted breve"
		],
		[
			"Ể",
			"Circumflex and hook above"
		],
		[
			"Ẹ",
			"Dot below"
		],
		[
			"Ḙ",
			"Circumflex below"
		],
		[
			"Ḛ",
			"Tilde below"
		],
		[
			"Ệ",
			"Circumflex and dot below"
		]
	]
F_Glyphs := [
	[
		"Ꞙ",
		"Stroke"
	],
	[
		"Ḟ",
		"Dot above"
	],
	[
		"Ƒ ",
		" Hook "
	]
]

G_Glyphs := [
	[
		"Ǵ",
		"Acute"
	],
	[
		"Ġ",
		"Dot above"
	],
	[
		"Ĝ",
		"Circumflex"
	],
	[
		"Ǧ",
		"Caron"
	],
	[
		"Ğ",
		"Breve"
	],
	[
		"Ḡ",
		"Macron"
	],
	[
		"Ģ",
		"Cedilla"
	],
	[
		"Ǥ",
		"Stroke "
	],
	[
		"Ɠ",
		"Hook"
	],
	[
		"ᶃ",
		"Palatal Hook"
	]
]

H_Glyphs := [
	[
		"Ḣ",
		"Dot above"
	],
	[
		"Ĥ",
		"Circumflex"
	],
	[
		"Ḧ",
		"Diaeresis"
	],
	[
		"Ȟ",
		"Caron"
	],
	[
		"Ḩ",
		"Cedilla"
	],
	[
		"Ħ",
		"Stroke"
	],
	[
		"Ḥ",
		"Dot below"
	],
	[
		"Ḫ",
		"Breve below"
	],
	[
		"ẖ",
		"Macron below"
	],
]

I_Glyphs := [
	[
		"Í",
		"Acute"
	],
	[
		"Ì",
		"Grave"
	],
	[
		"İ",
		"Dot above"
	],
	[
		"Î",
		"Circumflex"
	],
	[
		"Ï",
		"Diaeresis"
	],
	[
		"Ǐ",
		"Caron"
	],
	[
		"Ĭ",
		"Breve"
	],
	[
		"Ī",
		"Macron"
	],
	[
		"Ĩ",
		"Tilde"
	],
	[
		"Į",
		"Ogonek"
	],
	[
		"Ḯ",
		"Diaeresis and acute"
	],
	[
		"Ỉ",
		"Hook above"
	],
	[
		"Ȉ",
		"Double grave"
	],
	[
		"Ȋ",
		"Inverted breve"
	],
	[
		"Ị",
		"Dot below"
	],
	[
		"Ḭ",
		"Tilde below"
	]
]

J_Glyphs := [
	[
		"Ĵ",
		"Circumflex"
	]
]
K_Glyphs := [
	[
		"Ḱ",
		"Acute"
	],
	[
		"Ǩ",
		"Caron"
	],
	[
		"Ķ",
		"Cedilla"
	],
	[
		"Ḳ",
		"Dot below"
	],
	[
		"Ḵ",
		"Macron below"
	]
]

L_Glyphs := [
	[
		"Ĺ",
		"Acute"
	],
	[
		"Ľ",
		"Caron"
	],
	[
		"Ⱡ",
		"Double bar"
	],
	[
		"Ļ",
		"Cedilla"
	],
	[
		"Ƚ",
		"Bar"
	],
	[
		"Ł",
		"Stroke"
	],
	[
		"Ḷ",
		"Dot below"
	],
	[
		"Ḽ",
		"Circumflex below"
	],
	[
		"Ḻ",
		"Macron below"
	],
	[
		"Ḹ",
		"Dot below and macron"
	],
	[
		"Ꝉ",
		"High stroke"
	],
]

M_Glyphs := [
	[
		"Ḿ",
		"Acute"
	],
	[
		"Ṁ",
		"Dot above"
	],
	[
		"Ṃ",
		"Dot below"
	]
]

N_Glyphs := [
	[
		"Ń",
		"Acute"
	],
	[
		"Ǹ",
		"Grave"
	],
	[
		"Ṅ",
		"Dot above"
	],
	[
		"Ň",
		"Caron"
	],
	[
		"N̄",
		"Macron above"
	],
	[
		"Ñ",
		"Tilde"
	],
	[
		"Ņ",
		"Cedilla"
	],
	[
		"Ɲ",
		"Left hook"
	],
	[
		"Ƞ",
		"Long right leg"
	],
	[
		"Ṇ",
		"Dot below"
	],
	[
		"ɳ",
		"Retroflex hook"
	],
	[
		"Ṋ",
		"Circumflex below"
	],
	[
		"Ṉ",
		"Macron below"
	],
	[
		"ȵ",
		"Curl"
	],
	[
		"Ŋ",
		"Right hook"
	],
	[
		"Ꞑ",
		"Descender"
	]
]

O_Glyphs := [
	[
		"Ó",
		"Acute"
	],
	[
		"Ò",
		"Grave"
	],
	[
		"Ȯ",
		"Dot above"
	],
	[
		"Ô",
		"Circumflex"
	],
	[
		"Ö",
		"Diaeresis"
	],
	[
		"Ǒ",
		"Caron"
	],
	[
		"Ŏ",
		"Breve"
	],
	[
		"Ō",
		"Macron"
	],
	[
		"Õ",
		"Tilde"
	],
	[
		"Ǫ",
		"Ogonek"
	],
	[
		"Ő",
		"Double acute"
	],
	[
		"Ố",
		"Circumflex and acute"
	],
	[
		"Ồ",
		"Circumflex and grave"
	],
	[
		"Ṓ",
		"Macron and acute"
	],
	[
		"Ṑ",
		"Macron and grave"
	],
	[
		"Ȱ",
		"Dot above and macron"
	],
	[
		"Ṍ",
		"Tilde and acute"
	],
	[
		"Ȫ",
		"Diaeresis and macron"
	],
	[
		"Ỗ",
		"Circumflex and tilde"
	],
	[
		"Ṏ",
		"Tilde and diaeresis"
	],
	[
		"Ȭ",
		"Tilde and macron"
	],
	[
		"Ǭ",
		"Ogonek and macron"
	],
	[
		"Ỏ",
		"Hook above"
	],
	[
		"Ȍ",
		"Double grave"
	],
	[
		"Ȏ",
		"Inverted breve"
	],
	[
		"Ơ",
		"Horn"
	],
	[
		"Ổ",
		"Circumflex and hook above"
	],
	[
		"Ọ",
		"Dot below"
	],
	[
		"Ớ",
		"Horn and acute"
	],
	[
		"Ờ",
		"Horn and grave"
	],
	[
		"Ỡ",
		"Horn and tilde"
	],
	[
		"Ộ",
		"Circumflex and dot below"
	],
	[
		"Ở",
		"Horn and hook above"
	],
	[
		"Ợ",
		"Horn and dot below"
	],
	[
		"Ø",
		"O with slash"
	],
	[
		"Ǿ",
		"O with slash and acute"
	],
	[
		"Œ",
		"Ethel"
	]
]

P_Glyphs := [
	[
		"Ṕ",
		"Acute"
	],
	[
		"Ṗ",
		"Dot above"
	],
	[
		"Ᵽ",
		"Stroke"
	],
	[
		"Ƥ",
		"Hook"
	],
]

R_Glyphs := [
	[
		"Ŕ",
		"Acute"
	],
	[
		"Ṙ",
		"Dot above"
	],
	[
		"Ř",
		"Caron"
	],
	[
		"Ŗ",
		"Cedilla"
	],
	[
		"Ɽ",
		"Tail"
	],
	[
		"Ȑ",
		"Double grave"
	],
	[
		"Ȓ",
		"Inverted breve"
	],
	[
		"Ṛ",
		"Dot below"
	],
	[
		"Ṟ",
		"Macron below"
	],
	[
		"Ṝ",
		"Dot below and macron"
	],
	[
		"Ꝛ",
		"r rotunda"
	],
	[
		"Ꞧ",
		"Oblique Stroke"
	],
]

S_Glyphs := [
	[
		"Ś",
		"Acute"
	],
	[
		"Ṡ",
		"Dot above"
	],
	[
		"Ŝ",
		"Circumflex"
	],
	[
		"Š",
		"Caron"
	],
	[
		"Ş",
		"Cedilla"
	],
	[
		"Ṥ",
		"Acute and dot above"
	],
	[
		"Ṧ",
		"Caron and dot above"
	],
	[
		"Ṣ",
		"Dot below"
	],
	[
		"Ș",
		"Comma below"
	],
	[
		"Ṩ",
		"Dot below and dot above"
	],
	[
		"ß",
		"Eszett"
	]
]

T_Glyphs := [
	[
		"Ṫ",
		"Dot above"
	],
	[
		"ẗ",
		"Diaeresis"
	],
	[
		"Ť",
		"Caron"
	],
	[
		"Ţ",
		"Cedilla"
	],
	[
		"Ƭ",
		"Hook"
	],
	[
		"Ṭ",
		"Dot below"
	],
	[
		"Ț",
		"Comma below"
	],
	[
		"Ṱ",
		"Circumflex below"
	],
	[
		"Ṯ",
		"Macron below"
	],
	[
		"Ŧ ",
		" Bar "
	],
]

U_Glyphs := [
	[
		"Ú",
		"Acute"
	],
	[
		"Ù",
		"Grave"
	],
	[
		"Û",
		"Circumflex"
	],
	[
		"Ü",
		"Diaeresis"
	],
	[
		"Ǔ",
		"Caron"
	],
	[
		"Ŭ",
		"Breve"
	],
	[
		"Ū",
		"Macron"
	],
	[
		"Ũ",
		"Tilde"
	],
	[
		"Ů",
		"Ring above"
	],
	[
		"Ų",
		"Ogonek"
	],
	[
		"Ű",
		"Double acute"
	],
	[
		"Ǘ",
		"Diaeresis and acute"
	],
	[
		"Ǜ",
		"Diaeresis and grave"
	],
	[
		"Ǚ",
		"Diaeresis and caron"
	],
	[
		"Ṹ",
		"Tilde and acute"
	],
	[
		"Ǖ",
		"Diaeresis and macron"
	],
	[
		"Ṻ",
		"Macron and diaeresis"
	],
	[
		"Ủ",
		"Hook above"
	],
	[
		"Ȕ",
		"Double grave"
	],
	[
		"Ȗ",
		"Inverted breve"
	],
	[
		"Ư",
		"Horn"
	],
	[
		"Ụ",
		"Dot below"
	],
	[
		"Ṳ",
		"Diaeresis below"
	],
	[
		"Ứ",
		"Horn and acute"
	],
	[
		"Ừ",
		"Horn and grave"
	],
	[
		"Ṷ",
		"Circumflex below"
	],
	[
		"Ṵ",
		"Tilde below"
	],
	[
		"Ữ",
		"Horn and tilde"
	],
	[
		"Ử",
		"Horn and hook above"
	],
	[
		"Ự",
		"Horn and dot below"
	]
]

V_Glyphs := [
	[
		"Ṽ",
		"Tilde"
	],
	[
		"Ṿ",
		"Dot below"
	]
]

W_Glyphs := [
	[
		"Ẃ",
		"Acute"
	],
	[
		"Ẁ",
		"Grave"
	],
	[
		"Ẇ",
		"Dot above"
	],
	[
		"Ŵ",
		"Circumflex"
	],
	[
		"Ẅ",
		"Diaeresis"
	],
	[
		"ẘ",
		"Ring above"
	],
	[
		"Ẉ",
		"Dot below"
	]
]

X_Glyphs := [
	[
		"Ẋ",
		"Dot above"
	],
	[
		"Ẍ",
		"Diaeresis"
	]
]

Y_Glyphs := [
	[
		"Ý",
		"Acute"
	],
	[
		"Ỳ",
		"Grave"
	],
	[
		"Ẏ",
		"Dot above"
	],
	[
		"Ŷ",
		"Circumflex"
	],
	[
		"Ÿ",
		"Diaeresis"
	],
	[
		"Ȳ",
		"Macron"
	],
	[
		"Ỹ",
		"Tilde"
	],
	[
		"ẙ",
		"Ring above"
	],
	[
		"Ỷ",
		"Hook above"
	],
	[
		"Ỵ",
		"Dot below"
	]
]

Z_Glyphs := [
	[
		"Ź",
		"Acute"
	],
	[
		"Ż",
		"Dot above"
	],
	[
		"Ẑ",
		"Circumflex"
	],
	[
		"Ž",
		"Caron"
	],
	[
		"Ẓ",
		"Dot below"
	],
	[
		"Ẕ",
		"Macron below"
	],
	[
		"Ʒ",
		"Ezh"
	],
	[
		"Ǯ",
		"Ezh with caron"
	]
]


; TRAY ICON ==============================================================
{
	Create_Image(B64, NewHandle := True) {
		; This function adapted from Image2Include v2 by iPhilip https://www.autohotkey.com/boards/viewtopic.php?style=1&t=119966
		Static hBitmap := 0
		If (NewHandle)
			hBitmap := 0
		If (hBitmap)
			Return hBitmap

		If !DllCall("Crypt32.dll\CryptStringToBinary", "Ptr", StrPtr(B64), "UInt", 0, "UInt", 0x01, "Ptr", 0, "UIntP", &DecLen :=
		0, "Ptr", 0, "Ptr", 0)
			Return False
		Dec := Buffer(DecLen, 0)
		If !DllCall("Crypt32.dll\CryptStringToBinary", "Ptr", StrPtr(B64), "UInt", 0, "UInt", 0x01, "Ptr", Dec, "UIntP", &
		DecLen, "Ptr", 0, "Ptr", 0)
			Return False
		; Bitmap creation adopted from "How to convert Image data (JPEG/PNG/GIF) to hBITMAP?" by SKAN
		; -> http://www.autohotkey.com/board/topic/21213-how-to-convert-image-data-jpegpnggif-to-hbitmap/?p=139257
		hData := DllCall("Kernel32.dll\GlobalAlloc", "UInt", 2, "UPtr", DecLen, "UPtr")
		pData := DllCall("Kernel32.dll\GlobalLock", "Ptr", hData, "UPtr")
		DllCall("Kernel32.dll\RtlMoveMemory", "Ptr", pData, "Ptr", Dec, "UPtr", DecLen)
		DllCall("Kernel32.dll\GlobalUnlock", "Ptr", hData)
		DllCall("Ole32.dll\CreateStreamOnHGlobal", "Ptr", hData, "Int", True, "PtrP", pStream := ComValue(13, 0))
		hGdip := DllCall("Kernel32.dll\LoadLibrary", "Str", "Gdiplus.dll", "UPtr")
		SI := Buffer(8 + 2 * A_PtrSize, 0), NumPut("UInt", 1, SI, 0)
		DllCall("Gdiplus.dll\GdiplusStartup", "PtrP", &pToken := 0, "Ptr", SI, "Ptr", 0)
		DllCall("Gdiplus.dll\GdipCreateBitmapFromStream", "Ptr", pStream, "PtrP", &pBitmap := 0)
		DllCall("Gdiplus.dll\GdipCreateHBITMAPFromBitmap", "Ptr", pBitmap, "PtrP", &hBitmap := 0, "UInt", 0)
		DllCall("Gdiplus.dll\GdipDisposeImage", "Ptr", pBitmap)
		DllCall("Gdiplus.dll\GdiplusShutdown", "Ptr", pToken)
		DllCall("Kernel32.dll\FreeLibrary", "Ptr", hGdip)
		Return hBitmap
	}

	; Icons generated using Image2Include v2 by iPhilip https://www.autohotkey.com/boards/viewtopic.php?style=1&t=119966
	B64_Icon :=
		"AAABAAEAICAAAAEAIACoEAAAFgAAACgAAAAgAAAAQAAAAAEAIAAAAAAAABAAAA8LAAAPCwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAhnAQESagAABUkAAAArAAAAFQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQEBIC4EBEd6AwNDxwICK+QBAQ3QAAAAowAAAF4AAAAVAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBDsADQ0/wAICKYaBweGegYGbeQDA0L/AQET+wAAAMcAAABWAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAB8AAAUjBweSMwgIk68HB338AwNB/wEBC/UAAACTAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAABABARaAAgIh3gAACuMAAACHAwM4KAgIlIwICJP6BgZp/wEBGf4AAACkAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAATAgIpngYGa/wHB4r/BgZs/wICJP4AAAG+AQEYOwcHjJ0ICJX/BgZy/wEBEf4AAACBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAARAAAAAQAAAAAAAAEAAAAADwICJ54GBnX9CAiW/wgIkv4ICJLkBweF8QMDPf8AAAPQAgI1gwcHjfYICJX/AwM+/wAAAL4AAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABARYAAAAJWAAACK4AAAAiAAAAAAAAAAcBARuJBgZs/AgIlv8HB4z/BQVevgUFWy0HB4tLBweFzgQESf8BARj0BweB/QgIl/8EBEr/AAAAyAAAAA4AAAAAAAAAHwAAABYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAICJwABASBUAgI1+gAACLQAAAAvAAALZwQEWfUICJT/CAiS/wQEVtsBAQ4wAQEeAAgImwAGBnQnBweFuAQEWf8GBnz/CAiY/wQEUv8AAADMAAABIwEBHVgAAAikAAAAIQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAABoEBFbRBART/wICJOgDA0TvCAiO/wgIlv8GBm35AQEaZQUFcQAAAAAAAAADAAYGegAFBWseBweHvAgIkv8ICJX/BQVe/wICIvIDAz/YAgIx4gAAB14CAjUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgrGAAICMmUHB3v3CAiO/wgIkP8ICJX/BweJ/wMDOLQAAAAOAAABAAAAAAAAAAAAAQEbAAUFbQAFBWc4BweK7AgIlf8HB4X/BQVq7AUFWZsBARw8AAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAABwMDOZcHB4D/CAiV/wgIlf8FBWDyAAAKSQEBFAAAAAAAAAAAAAAAAAAAAAAAAwNBAAMDQiQHB4PlCAiW/wQES/8AAAS+AAABCgAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJAQEapgYGef8ICJb/BweH/wICMq0AAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAADA0kAAwNHLQcHhOwICJf/BARL/wAAAMkAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAFcEBE32CAiU/wgIlv8FBWP2AAAKTgEBEwAAAAAAAAAAAAAAAAAAAAAAAAAAAAkJvQADA0NFBweH8wgIl/8EBFT/AAAAzwAAABEAAAAAAAAAAAAAAAAAAAANAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPAQEdvgcHf/8ICJb/BweM/wMDOcAAAAAPAAAAAAAAAAAAAAAAAAAJAAAAAAkCAiU5BARJiQYGbNgICJD/CAiX/wQEVf8AAADQAAAAEgAAAQAFBW0ABQV5JQEBEpcAAABKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAE8DA0b2CAiU/wgIlv8GBnH+AQEVawICMQAAAAAAAwMzAAEBEhADA0BWBQVgswcHeu8ICI3/CAiV/wgIlf8ICJf/BQVc/wAAAN4AAAAdAAAAAQYGdjIFBWTHAQEQzwAAABkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAQEPowYGcf8ICJb/CAiT/wQETN8AAAAkAAAHAAEBDAkEBEpRBgZswQcHgPoHB4X/Bwd+8gYGdOAGBm/TBgZ23gcHifgGBnD/AQEa9AICMJoFBWOlBweA5AMDN/UAAABbAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACUCAirhBweM/wgIlf8HB4X/AgIqoQAAAAMCAjEvBARaqQYGbe0GBmnTBARVlwMDPmECAig4AQESHwAAAhQBARceBARJVAYGfMoHB4X/BweJ/wgIkP8EBFT6AAAIhwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUgMDQ/oICJX/CAiW/wYGa/wBAQ1hAgImXAMDRMwEBEujAwMySgAACRQAAAABAAAAAAAAAAEAAAAKAAAAAgAAAAAHB5IABgZwNggIjOUHB4H/BARR4AEBEnMAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAByBART/wgIlv8ICJX/BARR5QAAAHoBAR6nAgIhRQAAAAUAAAYAAAAAAAAAAAABASEAAQEXMgEBH7MAAAZ4AAAAEAEBFgAFBXQDBARJbQICLXkAAAcnAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAHYEBFX/CAiX/wgIkP8DAzzLAAAAJgAABQ0AAAcAAAAAAAAAAAAAAAAAAAAAAAEBGgAAAAoNAwNDmAMDNvsAAAenAAAAHQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAXAMDQ/0ICJX/BweK/wICLrgAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAICLQABAR8VBQVftAMDRv8AAAi8AAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAnAgIj4QcHiP8HB4z/AgIuwAAAAAsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDSgACAjYtBgZy2AQETv8AAAfGAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAaPBQVc/wgIlf8DA0PjAAAAJQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAkJugAEBE5aBweD9QQETP8AAATIAAAAJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACUCAiLVBweD/wUFZPwAAAdhAQEQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEbAAAAAAgGBm6kBweM/wMDNf8AAACsAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAFYDAz3vBweA/wICMMMAAAAaAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgZ7AAUFaEsICJD4BgZ7/wEBEfsAAABkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAB3IEBEz1BgZw/wICKKMAAAAWAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYGiwAHB4IABweFUwgIkfkICJL/AgIx/wAAAKwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQEBC3EEBEzwBgZw/gMDO7gAAAgzAAAAAQAAAAAAAAAAAAAAAAYGiQABAXIABweQFQcHkmYICJPaCAiU/wgIlv8DAzr/AAAAuQAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAACFkDAzreBgZs/wUFWOECAih0AQETGAcHggoHB44ZCAiSPQgIk4AICJPNCAiU+ggIlv8ICJP/BgZx/wEBGu4AAABkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADIBARusBARO9wYGbfwHB33TCAiSwQgIk9gICJTzCAiW/wgIlv8ICJH/BgZ3/wMDRPcBARO3AAAARwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAoAAANXAgImyAUFX/wHB4z/CAiT/wcHiP8GBnX/BQVa/gMDNusBARSwAAABUwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAKiwMDMfMDAz7/AgIj7wEBD74AAAKAAAAAOwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+A////gD////AP///gB///wAP//4AD/+MAAf/iAAE/4AYAP+APAH/wD4B/8B+B//Afgf/wP4HP4DwBj+BwAA/AQAAfwAAAH8ACMD/AHhB/wH4P/8D/B//A/4P/wP/B/+D/wP/wf+D/8D/gf/gPgH/8AAD//wAA//+AA///4A/8="

	TraySetIcon("HBITMAP:*" . Create_Image(B64_Icon))
}
